import"./style.css";import{storageAvailable,projectsOnLoad}from"./storage.js";import{projectDB}from"./projects.js";import{format,compareAsc}from"date-fns";import radialBtnsMenu from"./radialButtons.js";import leftDOM from"./left_panel.js";import rightDOM from"./right_panel.js";import addListeners from"./listeners.js";import iDelete from"./img/3643729_delete_trash_icon.svg";import iPencil from"./img/326602_edit_pencil_icon.svg";import iDatabase from"./img/185097_database_icon.svg";import iAdd from"./img/172525_plus_icon.svg";import iFlag0 from"./img/2561440_flag_icon_light.svg";import iFlag1 from"./img/2561440_flag_icon_medium.svg";import iFlag2 from"./img/2561440_flag_icon_dark.svg";const containerLHS=document.querySelector(".container-left");let projectList=projectsOnLoad();const leftPanelContent=leftDOM.onloadLeft(projectList);function callback_showProjectDetails(e){const t=document.querySelector(".container-right");deleteChildNodes(t);const r=e.target.innerText;let o;for(const e of projectList)e.name==r&&(o=e);const i=rightDOM.mainTitleRight(o),a=rightDOM.projectDescriptionLabel(),s=rightDOM.displayDescription(o),n=rightDOM.taskMgeBtn();rightDOM.taskAddBtn(),t.append(i,a,s,n),addListeners.listenerEditProjectDescription(),addListeners.listenerManageTasks()}function callback_deleteProject(e){const t=document.querySelector(".container-right"),r=document.querySelector(".container-left");deleteChildNodes(t),deleteChildNodes(r);let o=e.target.previousSibling.firstChild.data,i=0;for(const e of projectList)e.name==o&&projectList.splice(i,1),i=1;storageAvailable("localStorage")&&localStorage.setItem("projectList",JSON.stringify(projectList)),leftDOM.onloadLeft(projectList),addListeners.listenerDatabase(),addListeners.listenerDeleteProject()}function callback_addProject(){const e=document.querySelector(".container-right"),t=document.querySelector(".container-left");deleteChildNodes(e),deleteChildNodes(t),leftDOM.addProjectLoad(projectList),addListeners.listenerAddProject(),addListeners.listenerInputAddProject()}function callback_inputAddProject(e){if("Enter"===e.key){const e=document.querySelector(".input-box-add-project");let t=projectDB();t.name=e.value,t.describe="",projectList.push(t),console.log(projectList),storageAvailable("localStorage")&&localStorage.setItem("projectList",JSON.stringify(projectList)),deleteChildNodes(document.querySelector(".container-left")),leftDOM.onloadLeft(projectList),addListeners.listenerDatabase(),addListeners.listenerDeleteProject(),addListeners.listenerShowProjectDescription(),addListeners.listenerAddProject()}}function callback_resetDatabase(){const e=document.querySelector(".container-right"),t=document.querySelector(".container-left");deleteChildNodes(e),deleteChildNodes(t),_resetDatabase(),projectList=projectsOnLoad(),leftDOM.onloadLeft(projectList),addListeners.listenerDatabase(),addListeners.listenerDeleteProject(),addListeners.listenerShowProjectDescription()}function callback_editProjectDescription(){const e=document.querySelector(".container-right"),t=(document.querySelector(".container-left"),document.querySelector(".title-panel-right").innerHTML);let r;for(const e of projectList)e.name==t&&(r=e);const o=rightDOM.mainTitleRight(r),i=rightDOM.projectDescriptionLabel(),a=rightDOM.editDescriptionUI(),s=rightDOM.controlsAddEditTask();deleteChildNodes(e),e.append(o,i,a,s),addListeners.listenerSaveDescription(),addListeners.listenerCancelEditDescription()}function callback_cancelEditDescription(){const e=document.querySelector(".container-right"),t=document.querySelector(".title-panel-right"),r=t.innerHTML;let o;deleteChildNodes(e);for(const e of projectList)e.name==r&&(o=e);const i=rightDOM.projectDescriptionLabel(),a=rightDOM.displayDescription(o),s=rightDOM.taskMgeBtn();e.append(t,i,a,s),addListeners.listenerEditProjectDescription()}function callback_saveDescription(){const e=document.querySelector(".container-right");let t=document.querySelector(".title-panel-right");const r=t.innerHTML;let o,i=document.querySelector(".input-project-description").value;for(const e of projectList)e.name==r&&(e.describe=i,o=e);deleteChildNodes(e);const a=rightDOM.projectDescriptionLabel(),s=rightDOM.displayDescription(o),n=rightDOM.taskMgeBtn();e.append(t,a,s,n),addListeners.listenerEditProjectDescription(),addListeners.listenerManageTasks()}function callback_manageTasks(){const e=document.querySelector(".container-right");let t=document.querySelector(".title-panel-right");const r=t.innerHTML;let o;for(const e of projectList)e.name==r&&(o=e);t=rightDOM.mainTitleRight(o),deleteChildNodes(e);const i=rightDOM.showAllTasks(o);e.append(t,i,rightDOM.taskAddBtn()),addListeners.listenerEditTask(),addListeners.listenerDeleteTasks(),addListeners.listenerAddTasks()}function callback_editTask(e){const t=e.target.parentElement.parentElement.childNodes[0].innerText,r=document.querySelector(".container-right"),o=document.querySelector(".title-panel-right"),i=o.innerHTML;let a;for(const e of projectList)if(e.name==i)for(let r=0;r<e.tasks.length;r++)e.tasks[r][0]==t&&(e.tasks[r][4]="x",a=e.tasks[r]);deleteChildNodes(r),r.append(o,rightDOM.makeInputForm(a),rightDOM.controlsAddEditTask()),addListeners.listenerSaveEditedTask(),addListeners.listenerCancelEditTasks()}function callback_deleteTasks(e){let t=e.target.parentNode.parentNode.firstChild.innerText;document.querySelector(".container-right");const r=document.querySelector(".title-panel-right").innerHTML;for(const e of projectList)if(e.name==r)for(let r=0;r<e.tasks.length;r++)e.tasks[r][0]==t&&e.tasks.splice(r,1);storageAvailable("localStorage")&&localStorage.setItem("projectList",JSON.stringify(projectList)),callback_manageTasks()}function callback_addTasks(){const e=document.querySelector(".container-right"),t=document.querySelector(".title-panel-right");deleteChildNodes(e),e.append(t,rightDOM.makeInputForm(),rightDOM.controlsAddEditTask()),addListeners.listenerSaveNewTask(),addListeners.listenerCancelEditTasks()}function callback_saveNewTask(){const e=document.querySelector(".input-task-name"),t=document.querySelector(".input-task-describe"),r=document.querySelector(".input-task-date"),o=document.querySelector(".input-task-priority"),i=document.querySelector(".title-panel-right").innerHTML;if(e.value.trim().length>0){for(let a of projectList)if(a.name==i){let i;i=[e.value,t.value,r.value,o.value,"OK"],""===r.value&&(i[2]="2099-12-31",alert("No date entered. Default 31/12/2099 was used")),a.tasks.push(i),console.log(a.tasks),storageAvailable("localStorage")&&localStorage.setItem("projectList",JSON.stringify(projectList))}}else alert("New task needs to be assigned a name");callback_manageTasks()}function callback_saveEditedTask(){const e=document.querySelector(".input-task-name"),t=document.querySelector(".input-task-describe"),r=document.querySelector(".input-task-date"),o=document.querySelector(".input-task-priority");if(console.log(o.value),e.value.trim().length>0)for(let i of projectList)for(let a=0;a<i.tasks.length;a++){let s;"x"==i.tasks[a][4]&&(s=[e.value,t.value,r.value,o.value,"OK"],s[5]=i.tasks[a][5],i.tasks[a]=s,storageAvailable("localStorage")&&localStorage.setItem("projectList",JSON.stringify(projectList)))}else alert("New task needs to be assigned a name");console.log(projectList),callback_manageTasks()}function _resetDatabase(){if(storageAvailable("localStorage")){window.localStorage.clear();const e=projectsOnLoad();localStorage.setItem("projectList",JSON.stringify(e))}}function deleteChildNodes(e){for(;e.firstChild;)e.removeChild(e.lastChild)}addListeners.listenerDatabase(),addListeners.listenerDeleteProject(),addListeners.listenerShowProjectDescription(),addListeners.listenerAddProject();export{callback_showProjectDetails,callback_deleteProject,callback_addProject,callback_inputAddProject,callback_resetDatabase,callback_editProjectDescription,callback_cancelEditDescription,callback_saveDescription,callback_manageTasks,callback_editTask,callback_saveEditedTask,callback_deleteTasks,callback_addTasks,callback_saveNewTask};